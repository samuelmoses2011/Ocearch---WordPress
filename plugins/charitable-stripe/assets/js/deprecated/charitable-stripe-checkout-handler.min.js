!function(a){var t,o,e=StripeCheckout.configure({key:CHARITABLE_STRIPE_VARS.key,image:"",locale:"auto",token:function(o){a("#charitable-donation-form [name=stripe_token]").val(o.id),a("body").off("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",i),t.attr("data-use-ajax",1).trigger("submit"),a("body").on("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",i)}}),n=function(a){"stripe"===new CHARITABLE.Donation_Form(a).get_payment_method()&&a.attr("data-use-ajax",0)},i=function(t){return t.stopImmediatePropagation(),n(a(this)),a("body").off("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",i),a(this).trigger("submit"),a("body").on("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",i),!1};a("body").on("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",i),a("body").on("submit","#charitable-donation-form[data-use-ajax=0]",function(n){if(t=a(this),"stripe"!==(o=new CHARITABLE.Donation_Form(t)).get_payment_method())return!0;if(o.validate()){var i=100*o.get_amount();e.open({name:CHARITABLE_STRIPE_VARS.site_name,description:o.get_description(),email:o.get_email(),currency:CHARITABLE_STRIPE_VARS.currency,amount:i})}else alert(o.get_error_message());n.preventDefault()}),a("body").on("change","#charitable-gateway-selector input[name=gateway]",function(){n(a(this).parents("#charitable-donation-form"))}),a(document).ready(function(){var t=a("#charitable-donation-form");t.length&&n(t),a("#charitable-gateway-selector input[name=gateway]").trigger("change")}),a(window).on("popstate",function(){e.close()})}(jQuery);